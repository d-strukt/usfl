!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.usfl=t()}}(function(){var t;return function e(t,n,i){function o(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return o(n?n:e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,n){!function(e){function i(t,e,n,i,o){this._listener=e,this._isOnce=n,this.context=i,this._signal=t,this._priority=o||0}function o(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function r(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){r.prototype.dispatch.apply(t,arguments)}}i.prototype={active:!0,params:null,execute:function(t){var e,n;return this.active&&this._listener&&(n=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,n),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},r.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,n,o){var r,s=this._indexOfListener(t,n);if(-1!==s){if(r=this._bindings[s],r.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else r=new i(this,t,e,n,o),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var n,i=this._bindings.length;i--;)if(n=this._bindings[i],n._listener===t&&n.context===e)return i;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,n){return o(t,"add"),this._registerListener(t,!1,e,n)},addOnce:function(t,e,n){return o(t,"addOnce"),this._registerListener(t,!0,e,n)},remove:function(t,e){o(t,"remove");var n=this._indexOfListener(t,e);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=e),n){t=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=r;s.Signal=r,"function"==typeof t&&t.amd?t(function(){return s}):"undefined"!=typeof n&&n.exports?n.exports=s:e.signals=s}(this)},{}],2:[function(t,e){"use strict";var n={isArray:function(t){return t instanceof Array},sortNumeric:function(t){return t.sort(function(t,e){return t-e})},sortRandom:function(t){return t.sort(function(){return Math.random()>.5?-1:1})},getRandom:function(t){return t[Math.floor(Math.random()*t.length)]}};"object"==typeof e&&e.exports&&(e.exports=n)},{}],3:[function(t,e){"use strict";function n(){this.onChildComplete=new o.Signal,this.onComplete=new o.Signal,this.onProgress=new o.Signal,this.onError=new o.Signal,this.queue=[],this.index=0,this.loaders={},this.loaded=!1,this.webAudioContext=null,this.crossOrigin=!1,this.touchLocked=!1,this.numTotal=0,this.numLoaded=0}function i(){var t,e,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof window.ActiveXObject)for(e=0;3>e;e+=1){n=i[e];try{t=new window.ActiveXObject(n)}catch(o){}}return t}var o=t("signals");n.prototype={add:function(t,e){var i=new n.Loader(t,e);return i.webAudioContext=this.webAudioContext,i.crossOrigin=this.crossOrigin,i.touchLocked=this.touchLocked,this.queue.push(i),this.numTotal++,i},start:function(){this.numTotal=this.queue.length,this.next()},next:function(){if(0===this.queue.length)return this.loaded=!0,void this.onComplete.dispatch(this.loaders);var t=this.queue.pop(),e=this;t.onComplete.addOnce(function(){e.numLoaded++,e.onProgress.getNumListeners()>0&&e.onProgress.dispatch(e.numLoaded/e.numTotal),e.loaders[t.url]=t,e.onChildComplete.dispatch(t),e.next()}),t.onError.addOnce(function(){e.onError.dispatch(t),e.next()}),t.start()},addMultiple:function(t){for(var e=0;e<t.length;e++)this.add(t[e])},get:function(t){return this.loaders[t]}},n.Loader=function(t,e){this.url=t,this.type=e||this.url.split("?")[0].toLowerCase().split(".").pop(),this.onComplete=new o.Signal,this.onError=new o.Signal,this.webAudioContext=null,this.crossOrigin=!1,this.touchLocked=!1},n.Loader.prototype={start:function(){switch(this.type){case"mp3":case"ogg":this.loadAudio(this.webAudioContext,this.touchLocked);break;case"jpg":case"png":case"gif":this.loadImage(this.crossOrigin);break;case"json":this.loadJSON();break;default:throw"ERROR: Unknown type for file with URL: "+this.url}},loadAudio:function(t,e){t?this.loadWebAudio(t):this.loadHTML5Audio(e)},loadWebAudio:function(t){var e=new XMLHttpRequest;e.open("GET",this.url,!0),e.responseType="arraybuffer";var n=this;e.onload=function(){t.decodeAudioData(e.response,function(t){n.data=t,n.onComplete.dispatch(t)},function(){n.onError.dispatch()})},e.onerror=function(){n.onError.dispatch()},e.send()},loadHTML5Audio:function(t){var e=new Audio;this.data=e,e.name=this.url,e.preload="auto";var n=this;e.onerror=function(){n.onError.dispatch()},e.src=this.url,t?this.onComplete.dispatch(this.data):(e.load(),this.onComplete.dispatch(this.data))},loadImage:function(t){var e=new Image;this.data=e,e.name=this.url;var n=this;e.onload=function(){n.onComplete.dispatch(n.data)},e.onerror=function(){n.onError.dispatch()},t&&(e.crossOrigin="anonymous"),e.src=this.url},loadJSON:function(){function t(){return n.status>=400?void o.onError.dispatch():(o.json=o.data=JSON.parse(n.responseText),void o.onComplete.dispatch(o.data))}function e(){o.onError.dispatch()}var n=i();n.open("GET",this.url,!0),n.responseType="text";var o=this;"onload"in n&&"onerror"in n?(n.onload=t,n.onerror=e):n.onreadystatechange=function(){try{if(void 0!==this.done)return;this.status>=200&&this.status<300&&(this.done=!0,t()),this.status>=400&&(this.done=!0,e())}catch(n){}},n.send()}},"object"==typeof e&&e.exports&&(e.exports=n)},{signals:1}],4:[function(t,e){"use strict";function n(){this.webAudioContext=i.createContext(),this._sounds={},this._delayTimeouts=[],this._ext=void 0,this._isSupported=void 0,this._touchLocked=!1,this._queued=[],r.onPageHidden.add(function(){this.pauseAll()},this),r.onPageShown.add(function(){this.resumeAll()},this)}var i=t("./web-audio.js"),o=t("./html-audio.js"),r=t("./page-visibility.js");n.prototype={add:function(t,e,n){var r=this.webAudioContext&&!e.tagName?new i(this.webAudioContext):new o;return r.loop=!!n,r.add(e),this._sounds[t]=r,r},getExtension:function(){if(!this._ext){var t=document.createElement("audio");this._ext=t.canPlayType('audio/ogg; codecs="vorbis"')?".ogg":".mp3"}return this._ext},isSupported:function(){if(void 0===this._isSupported)try{var t=document.createElement("audio");this._isSupported=!(!t||!t.canPlayType('audio/ogg; codecs="vorbis"')&&!t.canPlayType("audio/mpeg;"))}catch(e){this._isSupported=!1}return this._isSupported},webAudioSupported:function(){return!!this.webAudioContext},get:function(t){return this._sounds[t]},play:function(t,e,n){if(this._touchLocked)return void this.queueUp(t,e,n);var i=this._sounds[t];if(i)if(void 0!==n&&(i.loop=n),void 0!==e&&e>0){var o=setTimeout(function(){i.play()},e);this._delayTimeouts.push(o)}else i.play()},mute:function(){for(var t in this._sounds)this._sounds[t].volume=0},unMute:function(){for(var t in this._sounds)this._sounds[t].volume=1},pause:function(t){this._sounds[t]&&this._sounds[t].pause()},stop:function(t){this._sounds[t]&&this._sounds[t].stop()},pauseAll:function(){for(var t in this._sounds)this._sounds[t].playing&&this._sounds[t].pause()},resumeAll:function(){for(var t in this._sounds)this._sounds[t].paused&&this._sounds[t].play()},stopAll:function(){for(var t in this._sounds)this._sounds[t].stop();for(var e=0;e<this._delayTimeouts.length;e++)clearTimeout(this._delayTimeouts[e]);this._delayTimeouts.length=0},getTouchLocked:function(){return this._touchLocked},setTouchLocked:function(t){this._touchLocked=t;var e=this,n=function(){e._touchLocked=!1,document.body.removeEventListener("touchstart",n);for(var t=0;t<e._queued.length;t++)e._queued[t]();e._queued.length=0};this._touchLocked&&document.body.addEventListener("touchstart",n,!1)},queueUp:function(t,e,n){var i=this,o=function(){i.play(t,e,n)};this._queued.push(o)}},"object"==typeof e&&e.exports&&(e.exports=n)},{"./html-audio.js":9,"./page-visibility.js":16,"./web-audio.js":26}],5:[function(){"use strict";!function(t){window.console=window.console||{log:t,warn:t,error:t,table:t},window.console.table=window.console.table||t}(function(){})},{}],6:[function(t,e){"use strict";function n(){return!!v.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i)}function i(){return!!v.match(/iPad/i)}function o(){return!!v.match(/iPhone/i)}function r(){return!!v.match(/iPod/i)}function s(){return i()||r()||o()}function u(){return!!v.match(/OS 5(_\d)+ like Mac OS X/i)}function a(){return!!v.match(/Android/i)}function c(){return!!(a()&&parseFloat(v.slice(v.indexOf("Android")+8))<4)}function d(){if(!a())return!1;var t=new RegExp(/AppleWebKit\/([\d.]+)/),e=t.exec(v),n=null===e?null:parseFloat(t.exec(v)[1]),i=null!==n&&537>n;return i}function h(){var t,e,n=-1;return"Microsoft Internet Explorer"===navigator.appName?(e=e,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==t.exec(e)&&(n=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(e=e,t=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==t.exec(e)&&(n=parseFloat(RegExp.$1))),n}function l(){var t=document.createElement("div");return t.innerHTML="<!--[if IE]><i></i><![endif]-->",1===t.getElementsByTagName("i").length}function f(){var t=document.createElement("div");return t.innerHTML="<!--[if lte IE 8]><i></i><![endif]-->",1===t.getElementsByTagName("i").length}function p(){return void 0!==window.devicePixelRatio?window.devicePixelRatio:1}function g(){return(a()?window.outerWidth:window.screen.width)*p()}function m(){return(a()?window.outerHeight:window.screen.height)*p()}var v=navigator.userAgent,_={mobile:n(),ipad:i(),iphone:o(),ipod:r(),ios:s(),ios5:u(),android:a(),androidOld:c(),androidStock:d(),ieVersion:h(),ie9down:l(),ie8down:f(),screenWidth:g(),screenHeight:m(),dpr:p(),retina:p()>1};"object"==typeof e&&e.exports&&(e.exports=_)},{}],7:[function(t,e){"use strict";function n(){function t(){n.innerHTML="FPS: "+r+"<br />AVE: "+s}function e(e){void 0===e&&(e=Date.now()),0===i&&(i=e),e-1e3>i&&(i=e,r=o,o=0,r>1&&(u++,a+=r,s=Math.floor(a/u)),t()),o++}var n=document.getElementById("fps"),i=0,o=0,r=0,s=0,u=0,a=0;return n||(n=document.createElement("div"),n.setAttribute("id","fps"),n.style.position="absolute",n.style.top="0px",n.style.right="0px",n.style.padding="2px 6px",n.style.zIndex="9999",n.style.background="#000",n.style.color="#fff",document.body.appendChild(n)),{update:e}}"object"==typeof e&&e.exports&&(e.exports=n)},{}],8:[function(t,e){"use strict";var n=t("signals"),i=function(){function t(){r.dispatch(e.isFullscreen())}var e,i=document.documentElement,o=!!(i.requestFullScreen||i.webkitRequestFullScreen||i.mozRequestFullScreen),r=new n.Signal;return o&&(document.addEventListener("fullscreenchange",t),document.addEventListener("mozfullscreenchange",t),document.addEventListener("webkitfullscreenchange",t)),e={isSupported:o,onChange:r,enter:function(t){t=t||document.documentElement;var e=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen;e&&e.call(t)},exit:function(){var t=document.exitFullscreen||document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;t&&t.call(document)},toggle:function(t){this.isFullscreen()?this.exit():this.enter(t)},isFullscreen:function(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen)}}}();"object"==typeof e&&e.exports&&(e.exports=i)},{signals:1}],9:[function(t,e){"use strict";function n(){this._sound=null,this._loop=!1,this._volume=1,this._playing=!1,this._paused=!1}n.prototype={add:function(t){return this._sound=t,this._sound},play:function(){void 0!==this._sound.volume&&(this._sound.volume=this._volume),this._sound.play(),this._playing=!0,this._paused=!1;var t=this;this._sound.addEventListener("ended",function(){t._loop?(this.currentTime=0,this.play()):t._playing=!1},!1)},pause:function(){this._sound.pause(),this._playing=!1,this._paused=!0},stop:function(){this._sound.pause(),this._playing=!1,this._paused=!1}},Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t}}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(t){isNaN(t)||(this._volume=t,this._sound&&void 0!==this._sound.volume&&(this._sound.volume=this._volume))}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(n.prototype,"sound",{get:function(){return this._sound}}),"object"==typeof e&&e.exports&&(e.exports=n)},{}],10:[function(t,e){"use strict";function n(){var t,e=function(){var e;return e="number"==typeof window.pageXOffset?function(e){var n=e.clientX||0,i=e.clientY||0,o=window.pageXOffset,r=window.pageYOffset;t.x=n+o,t.y=i+r,t.percentX=t.x/window.innerWidth,t.percentY=t.y/window.innerHeight}:function(e){e=e&&e.clientX?e:window.event;var n=e.clientX,i=e.clientY,o=document.documentElement,r=document.body,s=Math.max(o.scrollLeft,r.scrollLeft),u=Math.max(o.scrollTop,r.scrollTop);t.x=n+s,t.y=i+u,t.percentX=t.x/window.innerWidth,t.percentY=t.y/window.innerHeight}}();return t={x:0,y:0,percentX:0,percentY:0,isListening:!1,listen:function(n){return n?(document.body.addEventListener("mousemove",e),document.body.addEventListener("touchmove",e)):(document.body.removeEventListener("mousemove",e),document.body.removeEventListener("touchmove",e)),t.isListening=n,this}}}"object"==typeof e&&e.exports&&(e.exports=n)},{}],11:[function(t,e){var n={A:"A".charCodeAt(0),B:"B".charCodeAt(0),C:"C".charCodeAt(0),D:"D".charCodeAt(0),E:"E".charCodeAt(0),F:"F".charCodeAt(0),G:"G".charCodeAt(0),H:"H".charCodeAt(0),I:"I".charCodeAt(0),J:"J".charCodeAt(0),K:"K".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),N:"N".charCodeAt(0),O:"O".charCodeAt(0),P:"P".charCodeAt(0),Q:"Q".charCodeAt(0),R:"R".charCodeAt(0),S:"S".charCodeAt(0),T:"T".charCodeAt(0),U:"U".charCodeAt(0),V:"V".charCodeAt(0),W:"W".charCodeAt(0),X:"X".charCodeAt(0),Y:"Y".charCodeAt(0),Z:"Z".charCodeAt(0),ZERO:"0".charCodeAt(0),ONE:"1".charCodeAt(0),TWO:"2".charCodeAt(0),THREE:"3".charCodeAt(0),FOUR:"4".charCodeAt(0),FIVE:"5".charCodeAt(0),SIX:"6".charCodeAt(0),SEVEN:"7".charCodeAt(0),EIGHT:"8".charCodeAt(0),NINE:"9".charCodeAt(0),NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,UNDERSCORE:189,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};"object"==typeof e&&e.exports&&(e.exports=n)},{}],12:[function(t,e){"use strict";var n=function(t,e){return t||(t=window.event),t.srcElement&&(t.target=t.srcElement,t.currentTarget=e,t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0}),t},i=function(){return document.addEventListener?function(t,e,n){t.addEventListener(e,n,!1)}:function(t,e,i){t.attachEvent("on"+e,function(e){e=n(e,t),i(e)})}}(),o=function(){return document.addEventListener?function(t,e,n){t.removeEventListener(e,n,!1)}:function(t,e,n){t.detachEvent("on"+e,n)}}(),r={addEvent:i,removeEvent:o};"object"==typeof e&&e.exports&&(e.exports=r)},{}],13:[function(t,e){"use strict";function n(){function t(t){if(r){for(var e=r;e.next;)e=e.next;n(t,e)}else r=s=t;return t}function e(t){return t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===r&&(r=t.next),t===s&&(s=t.prev),t.next=t.prev=null,t}function n(t,n){return e(t),t.prev=n,t.next=n.next,n.next?n.next.prev=t:s=t,n.next=t,t}function i(t,n){return e(t),t.prev=n.prev,t.next=n,n.prev?n.prev.next=t:r=t,n.prev=t,t}function o(t,e){if(r){var n=Array.prototype.splice.call(arguments,2);n.unshift(null);for(var i=r;i;)n[0]=i,t.apply(e,n),i=i.next}}var r,s;return{getFirst:function(){return r},getLast:function(){return s},getCount:function(){for(var t=0,e=r;e;)t++,e=e.next;return t},add:t,remove:e,insertAfter:n,insertBefore:i,forEach:o}}"object"==typeof e&&e.exports&&(e.exports=n)},{}],14:[function(t,e){"use strict";var n=180/Math.PI,i=Math.PI/180,o={map:function(t,e,n,i,o){return t===e?i:(t-e)*(o-i)/(n-e)+i},lerp:function(t,e,n){return t+(e-t)*n},clamp:function(t,e,n){if(e>n){var i=e;e=n,n=i}return e>t?e:t>n?n:t},random:function(t,e){return isNaN(e)&&(e=t,t=0),t+Math.random()*(e-t)},difference:function(t,e){return Math.abs(t-e)},distanceSQ:function(t,e,n,i){var o=t-n,r=e-i;return o*o+r*r},distance:function(t,e,n,i){var r=o.distanceSQ(t,e,n,i);return Math.sqrt(r)},coinToss:function(){return Math.random()>.5},angle:function(t,e,n,i){var o=n-t,r=i-e;return Math.atan2(r,o)},degrees:function(t){return t*n},radians:function(t){return t*i},roundToNearest:function(t,e){return Math.round(t/e)*e},getIntersectionArea:function(t,e,n,i,o,r,s,u){var a=Math.max(0,Math.min(t+n,o+s)-Math.max(t,o)),c=Math.max(0,Math.min(e+i,r+u)-Math.max(e,r));return a*c},getOverlapX:function(t,e,n,i){return Math.max(0,Math.min(t+e,n+i)-Math.max(t,n))},getOverlapY:function(t,e,n,i){return Math.max(0,Math.min(t+e,n+i)-Math.max(t,n))},rotateToDEG:function(t,e){var n=(e-t)%360;return n!==n%180&&(n=0>n?n+360:n-360),t+n},rotateToRAD:function(t,e){var n=2*Math.PI,i=(e-t)%n;return i!==i%Math.PI&&(i=0>i?i+n:i-n),t+i},dotProduct:function(t,e,n,i){return t*n+e*i},crossProduct:function(t,e,n,i){return t*i-e*n},getCirclePoints:function(t,e,n,i,o,r){o=void 0===o?-Math.PI/2:o;for(var s,u=[],a=2*Math.PI,c=a/i,d=o;a+o>d;d+=c)s=void 0===r?{}:new r,s.x=t+n*Math.cos(d),s.y=e+n*Math.sin(d),u.push(s);return u}};"object"==typeof e&&e.exports&&(e.exports=o)},{}],15:[function(t,e){"use strict";function n(t){var e=[];return{getPool:function(){return e},get:function(){return e.length>0?e.pop():new t},dispose:function(t){e.push(t)},fill:function(n){for(;e.length<n;)e[e.length]=new t},empty:function(){e=[]}}}"object"==typeof e&&e.exports&&(e.exports=n)},{}],16:[function(t,e){"use strict";function n(){document[i]?s.dispatch():u.dispatch()}var i,o,r=t("signals"),s=new r.Signal,u=new r.Signal;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange"):"undefined"!=typeof document.mozHidden?(i="mozHidden",o="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange"),void 0!==o&&document.addEventListener(o,n,!1);var a={onPageShown:u,onPageHidden:s};"object"==typeof e&&e.exports&&(e.exports=a)},{signals:1}],17:[function(t,e){"use strict";var n=function(t,e,n,i){var o=(screen.width-n)/2,r=(screen.height-i)/2,s="width="+n+", height="+i+", top="+r+", left="+o+", directories=no, location=no, menubar=no, resizable=no, scrollbars=no, status=no, toolbar=no",u=window.open(t,e,s);return null===u||"undefined"==typeof u?!1:(window.focus&&u.focus(),!0)};"object"==typeof e&&e.exports&&(e.exports=n)},{}],18:[function(t,e){"use strict";var n;n=document.addEventListener?function(t,e){"complete"===document.readyState||"interactive"===document.readyState?t.call(e||this):document.addEventListener("DOMContentLoaded",function(){t.call(e||this)})}:function(t,e){"interactive"===document.readyState&&t.call(e||this),document.attachEvent("onreadystatechange",function(){"interactive"===document.readyState&&t.call(e||this)})},"object"==typeof e&&e.exports&&(e.exports=n)},{}],19:[function(t,e){"use strict";var n=function(t,e,n,i,o){var r,s=t.width,u=t.height;switch(o){case"fill":r=Math.max(e/s,n/u);break;case"fit":r=Math.min(e/s,n/u);break;case"fitWidth":r=e/s;break;case"fitHeight":r=n/u;break;default:r=Math.max(e/s,n/u)}t.width=Math.ceil(s*r),t.height=Math.ceil(u*r),i&&(t.x=Math.round(.5*(e-t.width)),t.y=Math.round(.5*(n-t.height)))};"object"==typeof e&&e.exports&&(e.exports=n)},{}],20:[function(t,e){"use strict";function n(t){"http"!==t.substr(0,4)}var i=t("./popup.js"),o={facebook:function(t){return i("http://www.facebook.com/share.php?u="+encodeURIComponent(t),"shareFacebook",720,480)},twitter:function(t,e,n,o){return i("https://twitter.com/intent/tweet?url="+encodeURIComponent(t)+"&text="+encodeURIComponent(e)+"&hashtags="+encodeURIComponent(n)+"&related="+encodeURIComponent(o),"shareTwitter",550,380)},googlePlus:function(t){return i("https://plus.google.com/share?url="+encodeURIComponent(t),"shareGooglePlus",550,380)},pinterest:function(t,e,o){return n(e),i("http://pinterest.com/pin/create/button/?url="+encodeURIComponent(t)+"&media="+encodeURIComponent(e)+"&description="+encodeURIComponent(o),"sharePinterest",630,280)},vkontakte:function(t,e,n,o){return i("http://vkontakte.ru/share.php?url="+encodeURIComponent(t)+"&title="+e+"&description="+n+"&image="+encodeURIComponent(o),"shareVK",550,380)},renren:function(t,e){return i("http://share.renren.com/share/buttonshare.do?link="+encodeURIComponent(t)+"&title="+e,"shareRenRen",900,480)},weibo:function(t,e,n){return i("http://service.weibo.com/share/share.php?url="+encodeURIComponent(t)+"&appkey=&title="+e+"&pic="+encodeURIComponent(n)+"&ralateUid=&language=zh_cn","shareWeibo",640,480)},facebookFeedDialog:function(t,e,o,r,s,u,a,c){n(r),n(c);var d="http://www.facebook.com/dialog/feed?app_id="+t+"&picture="+r+(s&&""!==s?"&source="+s:"")+"&name="+encodeURIComponent(e)+"&link="+o+"&caption="+encodeURIComponent(u)+"&description="+encodeURIComponent(a)+"&display=popup&show_error=true&redirect_uri="+c;return i(d,"shareFacebook",550,380)}};"object"==typeof e&&e.exports&&(e.exports=o)},{"./popup.js":17}],21:[function(t,e){"use strict";var n={saveJSON:function(t,e){return localStorage?(localStorage.setItem(t,JSON.stringify(e)),!0):!1},loadJSON:function(t){return localStorage&&localStorage.getItem(t)?JSON.parse(localStorage.getItem(t)):null},getImageDataURL:function(t,e,n){this.canvas||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")),this.canvas.width=e||t.width,this.canvas.height=n||t.height,this.context.drawImage(t,0,0);var i=this.canvas.toDataURL("image/png");return this.context.clearRect(0,0,e,n),i}};"object"==typeof e&&e.exports&&(e.exports=n)},{}],22:[function(t,e){"use strict";function n(t){return t.replace(/(\]|\[|\{|\}|\(|\)|\*|\+|\?|\.|\\)/g,"\\$1")}function i(t){return t.replace(/^\s+|\s+$/g,"")}function o(t){return t.replace(/^\s+/,"")}function r(t){return t.replace(/\s+$/,"")}function s(t,e,n){for(;t.length<n;)t=e+t;return t}function u(t,e,n){for(;t.length<n;)t+=e;return t}function a(t){var e=i(t);return e.replace(/\s+/g," ")}function c(t,e,i){var o=n(e),r=i?"g":"ig";return t.replace(new RegExp(o,r),"")}function d(t,e,n){void 0===n&&(n="..."),e-=n.length;var i=t;if(i.length>e){i=i.substr(0,e);var o=/[^\s]/;o.test(t.charAt(e))&&(i=r(i.replace(/\w+$|\s+$/,""))),i+=n}return i}function h(t,e){var n=o(t);return e?n.replace(/^.|\b./g,function(t){return t.toUpperCase()}):n.replace(/(^\w)/,function(t){return t.toUpperCase()})}function l(t){var e=t.toLowerCase().replace(/\b([^.?;!]+)/,h);return e.replace(/\b[i]\b/,"I")}function f(t){return t.split("").reverse().join("")}function p(t){return t.split(" ").reverse().join(" ")}function g(t){return t.replace(/<\/?[^>]+>/gim,"")}function m(t){return t.replace(/(\w)/,function(t){var e=t.toLowerCase(),n=t.toUpperCase();switch(t){case e:return n;case n:return e;default:return t}})}function v(t,e){return-1!==t.indexOf(e)}function _(t,e,i){var o=n(e),r=i?"g":"ig";return t.match(new RegExp(o,r)).length}function b(t,e){return t.lastIndexOf(e)===t.length-e.length}function y(t){var e=a(t);return!!e.length}function w(t){return!t.length}function x(t){var e=/^[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?$/;return e.test(t)}function E(t){return t.match(/\b\w+\b/g).length}function A(t,e){var n=t.indexOf(e);return-1===n?"":(n+=e.length,t.substr(n))}function C(t,e){var n=t.lastIndexOf(e);return-1===n?"":(n+=e.length,t.substr(n))}function L(t,e){return 0===t.indexOf(e)}function j(t,e){var n=t.indexOf(e);return-1===n?"":t.substr(0,n)}function S(t,e){var n=t.lastIndexOf(e);return-1===n?"":t.substr(0,n)}function O(t,e,n){var i="",o=t.indexOf(e);if(-1!==o){o+=e.length;var r=t.indexOf(n,o);-1!==r&&(i=t.substr(o,r-o))}return i}function T(t,e,i){void 0===i&&(i=".");var o=[];if(null===t||!v(t,i))return o;for(var r=0,s=t.length,u=new RegExp("[^"+n(i)+"]+$");s>r;){var a=t.substr(r,e);v(a,i)||(o.push(d(a,a.length)),r+=a.length),a=a.replace(u,""),o.push(a),r+=a.length}return o}function P(t,e){var n;if(null===t&&(t=""),null===e&&(e=""),t===e)return 0;var i,o,r=[],s=t.length,u=e.length;if(0===s)return u;if(0===u)return s;for(n=0;s>=n;n++)r[n]=[];for(n=0;s>=n;n++)r[n][0]=n;for(o=0;u>=o;o++)r[0][o]=o;for(n=1;s>=n;n++){var a=t.charAt(n-1);for(o=1;u>=o;o++){var c=e.charAt(o-1);i=a===c?0:1,r[n][o]=Math.min(r[n-1][o]+1,r[n][o-1]+1,r[n-1][o-1]+i)}}return r[s][u]}function M(t,e){var n=P(t,e),i=Math.max(t.length,e.length);return 0===i?1:1-n/i}var R={escapePattern:n,trim:i,trimLeft:o,trimRight:r,padLeft:s,padRight:u,removeExtraWhitespace:a,remove:c,truncate:d,capitalize:h,properCase:l,reverse:f,reverseWords:p,stripTags:g,swapCase:m,contains:v,countOf:_,endsWith:b,hasText:y,isEmpty:w,isNumeric:x,wordCount:E,afterFirst:A,afterLast:C,beginsWith:L,beforeFirst:j,beforeLast:S,between:O,block:T,editDistance:P,similarity:M};"object"==typeof e&&e.exports&&(e.exports=R)},{}],23:[function(t,e){"use strict";var n={};!function(){for(var t=/\+/g,e=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(t," "))},o=window.location.search.substring(1),r=e.exec(o);r;)n[i(r[1])]=i(r[2]),r=e.exec(o)}(),"object"==typeof e&&e.exports&&(e.exports=n)},{}],24:[function(t,e){"use strict";function n(){var t,e=["NETWORK_EMPTY","NETWORK_IDLE","NETWORK_LOADING","NETWORK_NO_SOURCE"],n=["HAVE_NOTHING","HAVE_METADATA","HAVE_CURRENT_DATA","HAVE_FUTURE_DATA","HAVE_ENOUGH_DATA"],o=["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"],r=null,s=new i.Signal,u=new i.Signal,a=new i.Signal,c=new i.Signal,d=new i.Signal,h=null,l=function(){s.dispatch(t)},f=function(){u.dispatch(t)},p=function(){c.dispatch(t)},g=function(e){a.dispatch(t,e.target.error)},m=function(){d.getNumListeners()>0&&d.dispatch(t,r.currentTime)},v=function(){null===r&&(r=document.createElement("video"),r.addEventListener("canplaythrough",l,!1),r.addEventListener("play",f,!1),r.addEventListener("playing",f,!1),r.addEventListener("error",g,!1),r.addEventListener("ended",p,!1),r.addEventListener("timeupdate",m,!1))},_=function(){if(clearTimeout(h),s.removeAll(),u.removeAll(),a.removeAll(),c.removeAll(),d.removeAll(),null!==r){r.pause();try{r.removeAttribute("src")}catch(t){}}},b=function(){_(),null!==r&&(r.removeEventListener("canplaythrough",l,!1),r.removeEventListener("play",f,!1),r.removeEventListener("playing",f,!1),r.removeEventListener("error",g,!1),r.removeEventListener("ended",p,!1),r.removeEventListener("timeupdate",m,!1),r.parentElement&&r.parentElement.removeChild(r),r=null)},y=function(t){null===r&&v(),r.setAttribute("preload","auto"),r.setAttribute("src",t),r.load()},w=function(t){void 0===t&&(t=40),x(),h=setTimeout(function(){E(),A(0)},t)},x=function(){r&&(clearTimeout(h),r.play())},E=function(){r&&r.pause()},A=function(t){try{r.currentTime=t}catch(e){}},C=function(){if(r){var t=r.networkState;return e[t]}return""},L=function(){if(r){var t=r.readyState;return n[t]}return""},j=function(){if(r){var t=r.error?r.error.code:0;return o[t]}return""},S=function(){if(isNaN(r.duration))return-1;var t=-1;return r.buffered&&r.buffered.length>0&&r.buffered.end&&r.duration&&(t=r.buffered.end(0)/r.duration,isNaN(t)&&(t=-1)),Math.round(10*t)/10};return t={onReady:s,onPlay:u,onError:a,onEnded:c,onTimeUpdate:d,create:v,load:y,forceLoad:w,unload:_,destroy:b,play:x,pause:E,seek:A,getBufferProgress:S,getReadyStateString:L,getNetworkStateString:C,getErrorStateString:j,getElement:function(){return r},getVolume:function(){return null===r?0/0:r.volume},setVolume:function(t){null!==r&&(r.volume=t)}}}var i=t("signals");"object"==typeof e&&e.exports&&(e.exports=n)},{signals:1}],25:[function(t,e){"use strict";var n=t("signals"),i=t("./resize.js"),o=t("./legacy/event-utils.js"),r={rect:{x:0,y:0,width:0,height:0,stageWidth:0,stageHeight:0,scale:1},originalWidth:0,originalHeight:0,init:function(t,e){this.originalWidth=t,this.originalHeight=e;var n=this;window.onresize=window.onorientationchange=function(){n.resize()},this.resize()},resize:function(){this.rect.x=0,this.rect.y=0,this.rect.width=this.originalWidth,this.rect.height=this.originalHeight,this.rect.stageWidth=this.getWindowWidth(),this.rect.stageHeight=this.getWindowHeight(),this.rect.scale=1,this.rect.stageWidth>this.rect.stageHeight?i(this.rect,this.rect.stageWidth,this.rect.stageHeight,!0,"fill"):i(this.rect,this.rect.stageWidth,this.rect.stageHeight,!0,"fitWidth"),this.rect.scale=this.rect.width/this.originalWidth,this.onResize.dispatch()},mouseLeftWindow:function(t,e){o.addEvent("mouseout",document,function(n){n=n?n:window.event;var i=n.relatedTarget||n.toElement;i&&"HTML"!==i.nodeName||t.call(e||this)})},getWindowWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0},getWindowHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0},getScrollTop:function(){return document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset||0},getWindowScrollY:function(){return window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop||0},getDocHeight:function(){return Math.max(document.body.scrollHeight||0,document.documentElement.scrollHeight||0,document.body.offsetHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0,document.documentElement.clientHeight||0)},getScrollPercentage:function(){return(this.getWindowScrollY()+this.getWindowHeight())/this.getDocHeight()*100},onResize:new n.Signal};"object"==typeof e&&e.exports&&(e.exports=r)
},{"./legacy/event-utils.js":12,"./resize.js":19,signals:1}],26:[function(t,e){"use strict";function n(t){this.context=t||n.createContext(),this.context&&(this._sound=[],this._node=[],this._gain=this.context.createGain(),this._gain.connect(this.context.destination),this._startedAt=0,this._pausedAt=0,this._loop=!1,this._playing=!1,this._nodeFactory=new n.NodeFactory(this.context))}n.prototype={add:function(t){return this._sound.push(new n.Sound(t,this.context)),this._sound[this._sound.length-1].loop=this._loop,this._sound[this._sound.length-1]},play:function(){for(var t,e=-1,n=0;n<this._sound.length;n++)this._sound[n].stop(),this._sound[n].connect(this._gain),this._sound[n].play(0,this._pausedAt/1e3),this._sound[n].duration>e&&(e=this._sound[n].duration,t=this._sound[n]);var i=this;t.source.onended=function(){i._playing=!1},this._startedAt=Date.now()-this._pausedAt,this._playing=!0},pause:function(){this.stop(),this._pausedAt=Date.now()-this._startedAt},stop:function(){for(var t=0;t<this._sound.length;t++)this._sound[t].stop();this._pausedAt=0,this._playing=!1}},Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t;for(var e=0;e<this._sound.length;e++)this._sound[e].loop=t}}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._gain.gain.value},set:function(t){isNaN(t)||(this._gain.gain.value=t)}}),Object.defineProperty(n.prototype,"playing",{get:function(){return this._playing}}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._pausedAt>0}}),Object.defineProperty(n.prototype,"sound",{get:function(){return this._sound}}),Object.defineProperty(n.prototype,"nodeFactory",{get:function(){return this._nodeFactory}}),n.createContext=function(){var t=null;return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext&&(t=new window.AudioContext),t},n.Sound=function(t,e){this._buffer=t,this._context=e,this._source=null,this._node=[],this._loop=!1,this.name=""},n.Sound.prototype={play:function(t,e){void 0===t?t=0:t>0&&(t=this._context.currentTime+t),void 0===e&&(e=0),this.source.loop=this._loop,this.source.start(t,e)},stop:function(){this._source&&(this._source.stop(0),this._source=null)},connect:function(t){this._node.length>0?this._node[this._node.length-1].connect(t):this.source.connect(t),this.destination=t},addNode:function(t){this._node.push(t),this.updateConnections()},updateConnections:function(){if(this._source){for(var t=0;t<this._node.length;t++)0===t?this._source.connect(this._node[t]):this._node[t-1].connect(this._node[t]);this.destination&&this.connect(this.destination)}}},Object.defineProperty(n.Sound.prototype,"source",{get:function(){return this._source||(this._source=this._context.createBufferSource(),this._source.buffer=this._buffer,this.updateConnections()),this._source}}),Object.defineProperty(n.Sound.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t}}),Object.defineProperty(n.Sound.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),n.NodeFactory=function(t){function e(e,n){var i=t.createBiquadFilter();return i.type=e,void 0!==n&&(i.frequency.value=n),i}function n(t,e){return void 0===t&&(t=e),t}return{gain:function(e){var n=t.createGain();return void 0!==e&&(n.gain.value=e),n},pan:function(e,i,o){var r=t.createPanner();return n(e,0),n(i,0),n(o,.5),r.setPosition(e,i,o),r},filter:{lowpass:function(t){return e("lowpass",t)},highpass:function(t){return e("highpass",t)},bandpass:function(t){return e("bandpass",t)},lowshelf:function(t){return e("lowshelf",t)},highshelf:function(t){return e("highshelf",t)},peaking:function(t){return e("peaking",t)},notch:function(t){return e("notch",t)},allpass:function(t){return e("allpass",t)}},delay:function(e){var n=t.createDelay();return void 0!==e&&(n.delayTime=e),n},convolver:function(){var e=t.createConvolver();return e},analyser:function(){var e=t.createAnalyser();return e.smoothingTimeConstant=.85,e}}},n.Effects=function(t){function e(e,n,i){e.linearRampToValueAtTime(n,t.currentTime+i)}return{fade:function(t,n,i){e(t.gain,n,i)}}},"object"==typeof e&&e.exports&&(e.exports=n)},{}],27:[function(t,e){"use strict";t("./lib/console-patch.js");var n={};n.ArrayUtils=t("./lib/array-utils.js"),n.AssetLoader=t("./lib/asset-loader.js"),n.AudioManager=t("./lib/audio-manager.js"),n.Device=t("./lib/device.js"),n.FPS=t("./lib/fps.js"),n.Fullscreen=t("./lib/fullscreen.js"),n.HTMLAudio=t("./lib/html-audio.js"),n.InputCoords=t("./lib/input-coords.js"),n.Keyboard=t("./lib/keyboard.js"),n.LinkedList=t("./lib/linked-list.js"),n.MathUtils=t("./lib/math-utils.js"),n.ObjectPool=t("./lib/object-pool.js"),n.PageVisibility=t("./lib/page-visibility.js"),n.popup=t("./lib/popup.js"),n.ready=t("./lib/ready.js"),n.resize=t("./lib/resize.js"),n.Share=t("./lib/share.js"),n.StorageUtils=t("./lib/storage-utils.js"),n.StringUtils=t("./lib/string-utils.js"),n.UrlParams=t("./lib/url-params.js"),n.VideoObject=t("./lib/video-object.js"),n.Viewport=t("./lib/viewport.js"),n.WebAudio=t("./lib/web-audio.js"),e.exports=n},{"./lib/array-utils.js":2,"./lib/asset-loader.js":3,"./lib/audio-manager.js":4,"./lib/console-patch.js":5,"./lib/device.js":6,"./lib/fps.js":7,"./lib/fullscreen.js":8,"./lib/html-audio.js":9,"./lib/input-coords.js":10,"./lib/keyboard.js":11,"./lib/linked-list.js":13,"./lib/math-utils.js":14,"./lib/object-pool.js":15,"./lib/page-visibility.js":16,"./lib/popup.js":17,"./lib/ready.js":18,"./lib/resize.js":19,"./lib/share.js":20,"./lib/storage-utils.js":21,"./lib/string-utils.js":22,"./lib/url-params.js":23,"./lib/video-object.js":24,"./lib/viewport.js":25,"./lib/web-audio.js":26}]},{},[27])(27)});